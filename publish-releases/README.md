# Publish Releases
This action will automatically detect which packages of a monorepo have changed to determine which packages to publish (and works fine with single repositories too).

## Requirements
- Pass in `secrets.GITHUB_TOKEN` into `GITHUB_TOKEN`.
  - :exclamation: Must be `GITHUB_TOKEN` and not a personal access token of a bot. :exclamation:
- Pass in personal access token of an account that has access to the Resideo organization as `NPM_TOKEN`.
- Optional: Specify `IGNORE` argument for directory of packages you don't want published.
- Optional: Passing in an argument for `NPM_PUBLISH` will run that command instead of `npm publish`.
  - :warning: However, if you provide this argument, it will run that script to publish for every package. :warning:

### Private Dependencies
> This has already been setup for `@resideo/zeus`.
- To access private packages on `Github Package Registry`, you must generate a personal access token, set it as a secret variable from your repository settings, and pass it in the workflow as `NPM_TOKEN`.
  - The reason why this is necessary is because the `GITHUB_TOKEN` generated by the action is only scoped to the repository from which you are running the action. Personal access tokens will share the same functionality except now Github recognizes your level of access to other projects outside of that one repository.


## Usage
```yaml
jobs:
  job_name:
    name: Job Name
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v1
    - name: Publish Releases
      uses: resideo/zeus/publish-release@master
      with:
        npm_publish: npm run my-custom-script
        ignore: package/to-ignore
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        NPM_TOKEN: ${{ secrets.RESIDEO_BOT_TOKEN }}
```
